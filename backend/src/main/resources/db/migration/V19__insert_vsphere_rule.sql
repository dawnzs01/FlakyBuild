
INSERT INTO plugin ( id, name, icon, update_time) VALUES ('fit2cloud-vsphere-plugin', 'VMware vSphere', 'vmware.png', concat(unix_timestamp(now()), '007'));

INSERT INTO rule_group (`name`, `description`, `level`, `plugin_id`, `flag`) VALUES ('VMware 安全检查', '安全检查，为您提供通信网络、计算环境和管理中心的网络安全检查。', '等保三级', 'fit2cloud-vsphere-plugin', 1);

SELECT @groupId := LAST_INSERT_ID();

INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('6503123d-6442-49f4-8118-883c354ac868', 'VMware vSphere Host 电源状态扫描', 1, 'LowRisk', 'VMware vSphere 检测账号下 Host 电源状态是否属于开机状态，属于视为“合规”，否则属于“不合规”', 'policies:\n  #检测账号下 Host 电源状态是否属于开机状态，属于视为“合规”，否则属于“不合规”\n  - name: vsphere-host-power-state\n    resource: vsphere.host\n    filters:\n      - not:\n        - type: system\n          power_state: ${{power_state}}', '[{\"key\":\"power_state\",\"name\":\"电源状态\",\"defaultValue\":\"POWERED_ON\",\"required\":true}]', 'fit2cloud-vsphere-plugin', 'VMware vSphere', 'vmware.png', concat(unix_timestamp(now()), '007'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('7b494857-7010-446f-9deb-aab10262160e', 'VMware vSphere Datacenter关联资源扫描', 1, 'HighRisk', 'VMware vSphere 检测账号下Datacenter是否关联host、network、vm，关联视为“合规”，否则属于“不合规”', 'policies:\n  - name: vsphere-datacenter-system\n    resource: vsphere.datacenter\n    filters:\n      - not:\n        - type: system\n          host_folder: ${{host_folder}}\n          network_folder: ${{network_folder}}\n          vm_folder: ${{vm_folder}}', '[{\"key\":\"host_folder\",\"name\":\"关联host\",\"defaultValue\":\"\'\'\",\"required\":true},{\"key\":\"network_folder\",\"name\":\"关联network\",\"defaultValue\":\"\'\'\",\"required\":true},{\"key\":\"vm_folder\",\"name\":\"关联vm\",\"defaultValue\":\"\'\'\",\"required\":true}]', 'fit2cloud-vsphere-plugin', 'VMware vSphere', 'vmware.png', concat(unix_timestamp(now()), '007'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('82d95569-e9be-4a26-a18e-f1590bac97fb', 'VMware vSphere Host 连接状态扫描', 1, 'LowRisk', 'VMware vSphere 检测账号下 Host 连接状态，连接视为“合规”，否则属于“不合规”', 'policies:\n  #检测账号下 Host 连接状态，连接视为“合规”，否则属于“不合规”\n  - name: vsphere-host-power-state\n    resource: vsphere.host\n    filters:\n      - not:\n        - type: system\n          connection_state: ${{connection_state}}', '[{\"key\":\"connection_state\",\"name\":\"连接状态\",\"defaultValue\":\"CONNECTED\",\"required\":true}]', 'fit2cloud-vsphere-plugin', 'VMware vSphere', 'vmware.png', concat(unix_timestamp(now()), '007'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('8dccd008-f79b-4460-9b55-539f488e009a', 'VMware vSphere ResourcePool CPU内存扫描', 1, 'LowRisk', 'VMware vSphere 检测账号下 ResourcePool CPU内存是否分配，分配视为“合规”，否则属于“不合规”', 'policies:\n  #检测账号下 ResourcePool CPU内存是否分配，分配视为“合规”，否则属于“不合规”\n  - name: vsphere-resourcepool-system\n    resource: vsphere.resourcepool\n    filters:\n      - not:\n        - type: system\n          cpu_allocation: ${{cpu_allocation}}\n          memory_allocation: ${{memory_allocation}}', '[{\"key\":\"cpu_allocation\",\"name\":\"CPU分配\",\"defaultValue\":\"0\",\"required\":true},{\"key\":\"memory_allocation\",\"name\":\"内存分配\",\"defaultValue\":\"0\",\"required\":true}]', 'fit2cloud-vsphere-plugin', 'VMware vSphere', 'vmware.png', concat(unix_timestamp(now()), '007'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('b62df3f7-581b-4591-9373-581dd3dcdd88', 'VMware vSphere Network 分布式类型扫描', 1, 'LowRisk', 'VMware vSphere 检测账号下 Network 是否属于分布式类型，属于视为“合规”，否则属于“不合规”', 'policies:\n  #检测账号下 Network 是否属于分布式类型，属于视为“合规”，否则属于“不合规”\n  - name: vsphere-network-type\n    resource: vsphere.network\n    filters:\n      - not:\n        - type: system\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"是否属于分布式类型\",\"defaultValue\":\"DISTRIBUTED_PORTGROUP\",\"required\":true}]', 'fit2cloud-vsphere-plugin', 'VMware vSphere', 'vmware.png', concat(unix_timestamp(now()), '007'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('b798aa33-bd01-47ac-8cec-64f4f5d02866', 'VMware vSphere VM 状态扫描', 1, 'MediumRisk', 'VMware vSphere 检测账号下 VM 是否符合条件，符合视为“合规”，否则属于“不合规”', 'policies:\n  #检测账号下 VM 是否符合条件，符合视为“合规”，否则属于“不合规”\n  - name: vsphere-vm-system\n    resource: vsphere.vm\n    filters:\n      - not:\n        - type: system\n          power_state: ${{power_state}}\n          cpu_count: ${{cpu_count}}\n          memory_size_mib: ${{memory_size_mib}}', '[{\"key\":\"power_state\",\"name\":\"电源状态\",\"defaultValue\":\"POWERED_ON\",\"required\":true},{\"key\":\"cpu_count\",\"name\":\"CPU最低值(核)\",\"defaultValue\":\"1\",\"required\":true},{\"key\":\"memory_size_mib\",\"name\":\"内存最低值(M)\",\"defaultValue\":\"1024\",\"required\":true}]', 'fit2cloud-vsphere-plugin', 'VMware vSphere', 'vmware.png', concat(unix_timestamp(now()), '007'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('d004829c-b359-4993-84fd-0441c1ea9c6b', 'VMware vSphere Cluster高可用状态扫描', 1, 'HighRisk', 'VMware vSphere 检测账号下Cluster具备高可用能力，视为“合规”，否则属于“不合规”', 'policies:\n  #检测账号下Cluster具备高可用能力，视为“合规”，否则属于“不合规”\n  - name: vsphere-cluster-ha-enabled\n    resource: vsphere.cluster\n    filters:\n      - not:\n        - type: ha-enabled\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"是否具备高可用\",\"defaultValue\":\"true\",\"required\":true}]', 'fit2cloud-vsphere-plugin', 'VMware vSphere', 'vmware.png', concat(unix_timestamp(now()), '007'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('e9d801ab-3790-415e-9565-bd7208cb1b54', 'VMware vSphere Datastore 多主机访问扫描', 1, 'MediumRisk', 'VMware vSphere 检测账号下 Datastore 是否支持多主机访问，支持视为“合规”，否则属于“不合规”', 'policies:\n  - name: vsphere-datastore-host\n    resource: vsphere.datastore\n    filters:\n      - not:\n        - type: system\n          multiple_host_access: ${{multiple_host_access}}', '[{\"key\":\"multiple_host_access\",\"name\":\"是否支持多主机访问\",\"defaultValue\":\"true\",\"required\":true}]', 'fit2cloud-vsphere-plugin', 'VMware vSphere', 'vmware.png', concat(unix_timestamp(now()), '007'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('eab382c4-49db-420c-b4e1-987b47bf6661', 'VMware vSphere Datastore 可用空间扫描', 1, 'LowRisk', 'VMware vSphere 检测账号下 Datastore 可用空间是否满足条件，满足视为“合规”，否则属于“不合规”', 'policies:\n  - name: vsphere-datastore-thin-provisioning\n    resource: vsphere.datastore\n    filters:\n      - not:\n        - type: system\n          free_space: ${{free_space}}', '[{\"key\":\"free_space\",\"name\":\"可用空间是否大于(G)\",\"defaultValue\":\"500\",\"required\":true}]', 'fit2cloud-vsphere-plugin', 'VMware vSphere', 'vmware.png', concat(unix_timestamp(now()), '007'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('faa53ae5-f534-4a3c-85e2-22398dadd468', 'VMware vSphere Datastore 精简配置扫描', 1, 'LowRisk', 'VMware vSphere 检测账号下 Datastore 是否支持精简配置，支持视为“合规”，否则属于“不合规”', 'policies:\n  - name: vsphere-datastore-thin-provisioning\n    resource: vsphere.datastore\n    filters:\n      - not:\n        - type: system\n          thin_provisioning_supported: ${{thin_provisioning_supported}}', '[{\"key\":\"thin_provisioning_supported\",\"name\":\"是否支持精简配置\",\"defaultValue\":\"true\",\"required\":true}]', 'fit2cloud-vsphere-plugin', 'VMware vSphere', 'vmware.png', concat(unix_timestamp(now()), '007'), 1, 'custodian');


INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('d004829c-b359-4993-84fd-0441c1ea9c6b', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('7b494857-7010-446f-9deb-aab10262160e', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('e9d801ab-3790-415e-9565-bd7208cb1b54', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('faa53ae5-f534-4a3c-85e2-22398dadd468', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('eab382c4-49db-420c-b4e1-987b47bf6661', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('82d95569-e9be-4a26-a18e-f1590bac97fb', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('6503123d-6442-49f4-8118-883c354ac868', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('b62df3f7-581b-4591-9373-581dd3dcdd88', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('8dccd008-f79b-4460-9b55-539f488e009a', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('b798aa33-bd01-47ac-8cec-64f4f5d02866', 'safety');


INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('d004829c-b359-4993-84fd-0441c1ea9c6b', '2');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('d004829c-b359-4993-84fd-0441c1ea9c6b', '58');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('7b494857-7010-446f-9deb-aab10262160e', '64');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('e9d801ab-3790-415e-9565-bd7208cb1b54', '64');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('faa53ae5-f534-4a3c-85e2-22398dadd468', '64');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('eab382c4-49db-420c-b4e1-987b47bf6661', '59');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('eab382c4-49db-420c-b4e1-987b47bf6661', '60');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('82d95569-e9be-4a26-a18e-f1590bac97fb', '17');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('6503123d-6442-49f4-8118-883c354ac868', '17');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('b62df3f7-581b-4591-9373-581dd3dcdd88', '3');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('8dccd008-f79b-4460-9b55-539f488e009a', '64');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('b798aa33-bd01-47ac-8cec-64f4f5d02866', '64');


INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('d004829c-b359-4993-84fd-0441c1ea9c6b', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('7b494857-7010-446f-9deb-aab10262160e', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('e9d801ab-3790-415e-9565-bd7208cb1b54', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('faa53ae5-f534-4a3c-85e2-22398dadd468', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('eab382c4-49db-420c-b4e1-987b47bf6661', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('82d95569-e9be-4a26-a18e-f1590bac97fb', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('6503123d-6442-49f4-8118-883c354ac868', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('b62df3f7-581b-4591-9373-581dd3dcdd88', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('8dccd008-f79b-4460-9b55-539f488e009a', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('b798aa33-bd01-47ac-8cec-64f4f5d02866', @groupId);


INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('06e232b8-c8df-4bb5-9ce2-997bcbdc5e7a', '6503123d-6442-49f4-8118-883c354ac868', 'vsphere.host');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('2044548f-cde9-4e2b-9105-52f1687c6407', 'faa53ae5-f534-4a3c-85e2-22398dadd468', 'vsphere.datastore');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('2578e430-be92-4975-b038-25fa92f35166', '8dccd008-f79b-4460-9b55-539f488e009a', 'vsphere.resourcepool');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('29085daa-a551-4dda-9f71-1409484b2c99', 'e9d801ab-3790-415e-9565-bd7208cb1b54', 'vsphere.datastore');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('7f240477-21f6-432e-a43d-64ca71e1b5f2', 'b798aa33-bd01-47ac-8cec-64f4f5d02866', 'vsphere.vm');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('92791f37-ebc9-47a1-b025-add90d171704', 'b62df3f7-581b-4591-9373-581dd3dcdd88', 'vsphere.network');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('b817e070-49c1-47cc-9b5a-f19904ff2e91', '7b494857-7010-446f-9deb-aab10262160e', 'vsphere.datacenter');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('bb2dd4df-3fe9-4c26-841b-59fa6b744b83', 'eab382c4-49db-420c-b4e1-987b47bf6661', 'vsphere.datastore');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('ecb5e5a9-d286-41cb-bec9-d022f3773457', '82d95569-e9be-4a26-a18e-f1590bac97fb', 'vsphere.host');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('f526d8d1-b39e-4b95-9da9-f103376a04fd', 'd004829c-b359-4993-84fd-0441c1ea9c6b', 'vsphere.cluster');
